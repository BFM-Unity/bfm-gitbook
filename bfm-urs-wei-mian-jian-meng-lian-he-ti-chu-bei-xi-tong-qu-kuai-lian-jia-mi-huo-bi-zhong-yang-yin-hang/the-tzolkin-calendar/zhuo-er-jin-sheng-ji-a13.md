# 卓尔金升级A13

ASK：\
\
如果对一组数据取ln，取ln后的结果服从正态分布。 而且这组数据，随时间变化是一种指数下降的状态。 请问如何计算这组数据分布区间的均线，上轨和下轨。 请用Excel函数程序具体说明。

请注意，普通正态分布和指数正态分布服从的分布函数是不同的，线性下降和指数下降的数据服从的时间变化率函数也是不同的，如果这组数据服从指数正态分布而不是普通正态分布，服从线性下降而不是指数下降，以上公式是否会发生变化？

ANSWER：

对于服从指数正态分布的数据，我们需要对数据进行对数变换以使其服从正态分布。然后，我们可以使用相同的方法来计算均线，上轨和下轨。但是，需要注意的是，这些计算出的均线，上轨和下轨是对数变换后的数据的均线，上轨和下轨，而不是原始数据的。

对于时间变化率，如果数据是线性下降的，那么我们可以直接使用上述方法。但是，如果数据是指数下降的，那么我们需要先对数据进行对数变换，然后再进行计算。

以下是在Excel中进行这些计算的步骤：

1. **对数变换**：假设你的数据在A列，你可以在B列进行对数变换，即在B1单元格输入`=LN(A1)`，然后将这个公式向下拖动到其他单元格。
2. **均线**：我们可以使用`AVERAGE`函数来计算均线。在C1单元格输入`=AVERAGE($B$1:$B1)`，然后将这个公式向下拖动到其他单元格。
3. **上轨和下轨**：我们可以使用`STDEV.P`函数来计算标准差，然后用均值加减两倍的标准差来得到上轨和下轨。在D1单元格输入`=C1+2*STDEV.P($B$1:$B1)`，在E1单元格输入`=C1-2*STDEV.P($B$1:$B1)`，然后将这两个公式向下拖动到其他单元格。

```excel
A       B       C       D       E
1   数据    对数变换    均线    上轨    下轨
2   ...     =LN(A2)   =AVERAGE($B$1:$B2)   =C2+2*STDEV.P($B$1:$B2)   =C2-2*STDEV.P($B$1:$B2)
3   ...     =LN(A3)   =AVERAGE($B$1:$B3)   =C3+2*STDEV.P($B$1:$B3)   =C3-2*STDEV.P($B$1:$B3)
4   ...     =LN(A4)   =AVERAGE($B$1:$B4)   =C4+2*STDEV.P($B$1:$B4)   =C4-2*STDEV.P($B$1:$B4)
5   ...     =LN(A5)   =AVERAGE($B$1:$B5)   =C5+2*STDEV.P($B$1:$B5)   =C5-2*STDEV.P($B$1:$
```

ASK：

如果对一组数据取ln，取ln后的结果服从正态分布。 而且这组数据，随时间变化是一种指数下降的状态。 请问如何计算这组数据分布区间的均线，上轨和下轨。 请用Excel函数程序具体说明。

请注意，普通正态分布和指数正态分布服从的分布函数是不同的，线性下降和指数下降的数据服从的时间变化率函数也是不同的，如果这组数据服从指数正态分布而不是普通正态分布，服从线性下降而不是指数下降，以上公式是否会发生变化？

请注意，如果我事先不知道数据是线性下降和指数下降的，我认为数据Y随时间t的变化是服从函数

Y=A+B_t+C_EXP(D\*t)的，其中A，B，C，D为常数。

同时我认为数据Y的分布函数是一个正态分布和指数正态分布的线性叠加。

请问如何对数据进行简单的回归分析，确定数据Y在各个时刻的分布函数和Y随时间t的变化函数？

**ANSWER：计算数据分布区间的均线，上轨和下轨**

[在Excel中，可以使用以下公式来计算数据分布区间的均线，上轨和下轨](https://www.zhihu.com/question/384284854)[1](https://www.zhihu.com/question/384284854)：

* 中轨线（均线）：`=AVERAGE(数据范围)`
* 上轨线：`=AVERAGE(数据范围) + 2*STDEV.P(数据范围)`
* 下轨线：`=AVERAGE(数据范围) - 2*STDEV.P(数据范围)`

其中，`AVERAGE`函数用于计算平均值，`STDEV.P`函数用于计算标准差。

**正态分布和指数正态分布**

[正态分布和指数正态分布的确是不同的分布函数](https://baike.baidu.com/item/%E5%AF%B9%E6%95%B0%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83/8976782)[2](https://baike.baidu.com/item/%E5%AF%B9%E6%95%B0%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83/8976782)[。正态分布是一种对称分布，其概率密度函数的形状为钟形，而指数正态分布（也称为对数正态分布）则是非对称的，其概率密度函数的形状为偏斜的钟形](https://baike.baidu.com/item/%E5%AF%B9%E6%95%B0%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83/8976782)[2](https://baike.baidu.com/item/%E5%AF%B9%E6%95%B0%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83/8976782)。

**线性下降和指数下降**

[线性下降和指数下降描述的是数据随时间变化的速率](https://www.zhihu.com/question/384284854)[3](https://zhidao.baidu.com/question/1448047508944188980.html)[。线性下降意味着数据随时间以恒定的速率下降，而指数下降则意味着数据的下降速率与当前值成正比](https://blog.csdn.net/zhufenghao/article/details/80879260)[4](https://blog.csdn.net/zhufenghao/article/details/80879260)。

**回归分析**

[在Excel中，可以使用`LINEST`函数进行简单的线性回归分析](https://blog.csdn.net/qq\_39783601/article/details/108406696)[5](https://blog.csdn.net/qq\_39783601/article/details/108406696)。对于更复杂的模型，如您提到的`Y=A+B*t+C*EXP(D*t)`，可能需要使用更专业的统计软件，如R或Python的`scipy`库。

同时，对于数据Y的分布函数是一个正态分布和指数正态分布的线性叠加的情况，这是一个混合模型，可能需要使用期望最大化（EM）算法等更复杂的方法进行参数估计，这通常超出了Excel的功能范围。

以上是一些基本的指导，具体的实施可能需要根据您的数据和需求进行调整。如果需要更深入的统计分析，可能需要寻求专业统计软件或统计专家的帮助。
