# 卓尔金升级A13

ASK：\
\
如果对一组数据取ln，取ln后的结果服从正态分布。 而且这组数据，随时间变化是一种指数下降的状态。 请问如何计算这组数据分布区间的均线，上轨和下轨。 请用Excel函数程序具体说明。

请注意，普通正态分布和指数正态分布服从的分布函数是不同的，线性下降和指数下降的数据服从的时间变化率函数也是不同的，如果这组数据服从指数正态分布而不是普通正态分布，服从线性下降而不是指数下降，以上公式是否会发生变化？

ANSWER：

对于服从指数正态分布的数据，我们需要对数据进行对数变换以使其服从正态分布。然后，我们可以使用相同的方法来计算均线，上轨和下轨。但是，需要注意的是，这些计算出的均线，上轨和下轨是对数变换后的数据的均线，上轨和下轨，而不是原始数据的。

对于时间变化率，如果数据是线性下降的，那么我们可以直接使用上述方法。但是，如果数据是指数下降的，那么我们需要先对数据进行对数变换，然后再进行计算。

以下是在Excel中进行这些计算的步骤：

1. **对数变换**：假设你的数据在A列，你可以在B列进行对数变换，即在B1单元格输入`=LN(A1)`，然后将这个公式向下拖动到其他单元格。
2. **均线**：我们可以使用`AVERAGE`函数来计算均线。在C1单元格输入`=AVERAGE($B$1:$B1)`，然后将这个公式向下拖动到其他单元格。
3. **上轨和下轨**：我们可以使用`STDEV.P`函数来计算标准差，然后用均值加减两倍的标准差来得到上轨和下轨。在D1单元格输入`=C1+2*STDEV.P($B$1:$B1)`，在E1单元格输入`=C1-2*STDEV.P($B$1:$B1)`，然后将这两个公式向下拖动到其他单元格。

```excel
A       B       C       D       E
1   数据    对数变换    均线    上轨    下轨
2   ...     =LN(A2)   =AVERAGE($B$1:$B2)   =C2+2*STDEV.P($B$1:$B2)   =C2-2*STDEV.P($B$1:$B2)
3   ...     =LN(A3)   =AVERAGE($B$1:$B3)   =C3+2*STDEV.P($B$1:$B3)   =C3-2*STDEV.P($B$1:$B3)
4   ...     =LN(A4)   =AVERAGE($B$1:$B4)   =C4+2*STDEV.P($B$1:$B4)   =C4-2*STDEV.P($B$1:$B4)
5   ...     =LN(A5)   =AVERAGE($B$1:$B5)   =C5+2*STDEV.P($B$1:$B5)   =C5-2*STDEV.P($B$1:$
```
